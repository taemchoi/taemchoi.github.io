---
title: "IoC, DI, 그리고 컨테이너"
tags: [spring]
categories:
  - spring
date: 2022-12-16
toc : true
---

`본 POST는 인프런강의 [김영한 강사의 '스프링 핵심 원리 - 기본편']을 듣고 정리하였습니다. 모든 저작권은 인프런 및 김영한 강사에 있습니다. 문제가 될 시 삭제 하도록 하겠습니다.` 

## 1. IoC(Inversion of Control)
- 기존 프로그램은 클라이언트 구현체가 스스로 필요한 서버 구현체를 생성하고 연결하고 실행했다. 즉, 클라이언트 구현체가 프로그램 제어 흐름을 조정함
- 실행영역과 구성영역으로 나누면(*AppConfig) 구현체는 자신의 로직 실행만 담당
- 프로그램 제어 역할을 AppConfig가 권한을 갖게 됨
- 이렇게 프로그램의 제어 흐름을 구현체가 직접 제어하는 것이 아니라 외부에서 관리하는 것을 **IoC(제어의 역전)**이라 함

### 1.1 프레임워크 vs 라이브러리
- 프레임워크 : 내가 작성 코드를 외부에서 제어하고 실행하는 경우, 프레임워크(JUnit)
- 라이브러리 : 내가 작성한 코드가 직접 제어의 흐름을 담당한 경우, 라이브러리

## 2. DI(Dependency Injection)
- 의존관계는 **정적인 클래스 의존 관계와 실행 시점에 결정되는 동적인 의존관계를 분리**해서 생각해야 함
    - 정적인 의존관계 : 클래스가 사용하는 import코드만 보고 의존관계 쉽게 판단 가능, 직접 실행하지 않아도 의존관계 분석 가능(클래스 다이어그램)
    - 동적인 의존관계 : 애플리케이션 실행 시점에 실제 생성된 객체 인스턴스의 참조가 연결된 의존관계(객체 다이어그램을 보면 됨) --> *DI(의존관계 주입)*

- 객체 인스턴스를 생성하고 그 참조값을 전달하여 연결
- 클라이언트 코드를 변경하지않고 클라이언트가 호출하는 대상의 타입 인스턴스를 변경 가능
- 정적인 클래스 의존관계를 변경하지 않고 동적인 객체 인스턴스 의존관계 변경 가능

## 3. 컨테이너
- AppConfig 처럼 객체를 생성하고 관리하면서 의존관계를 연결해주는 것을 **IoC컨테이너 or DI컨테이너**라고 함
- DI 컨테이너라고 주로 부름(어샘블러, 오브젝트 팩토리 등으로도 불림)
- `ApplicationContext`를 스프링 컨테이너라고 한다.
- 컨테이너는 `@Bean`이라 적힌 메서드를 모두 호출해서 반환된 객체를 스프링컨테이너에 등록
    - 스프링 빈은 ApplicationContext.getBean() 메서드를 활용하여 찾을 수 있음  

``` java
ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class)
```  
- ApplicationContext --> 스프링 컨테이너, 인터페이스 
- ApplicationContext를 구현한 것 중 하나가 AnnotationConfigApplicationContext(어노테이션 기반의 자바 설정 클래스)
- 스프링컨테이너는 *"BeanFactory"*와 *"ApplicationContext"*로 구분해서 이야기 하지만 BeanFactory를 직접적으로 사용하는 경우 거의 없음


### 3.1 스프링 컨테이너의 생성 과정
1. 스프링 컨테이너 생성 
2. AppConfig.class를 구성정보로 지정 
3. 내부 스프링 빈 저장소에 이름과 객체를 등록
4. 스프링 빈 의존관계 설정(DI)
